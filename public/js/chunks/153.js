(window.webpackJsonp=window.webpackJsonp||[]).push([[153],{549:function(t,e,a){"use strict";a.r(e);a(4);var n=new Date,s=""+(n.getMonth()+1),i=""+n.getDate(),o=n.getFullYear();s.length<2&&(s="0"+s),i.length<2&&(i="0"+i);var r=[o,s,i].join("-"),c={data:function(){return{errors:0,department:"",section:"",departments:[],classes:[],students:[],attendence:[],lists:[],attd_date:r,maxDate:r,s:"",loaded:0,token:localStorage.getItem("token")}},mounted:function(){this.getDepts()},methods:{printTimeTable:function(){var t=document.getElementById("timetable"),e=window.open("","Time-Table","width=800,height=600");e.document.open();var a='\n            <html>\n                <head>\n                    <title>Time-Table</title>\n                    <style>\n                    body {\n                        margin:0;\n                        font-family: sans-serif;\n                    }\n                    table {\n                        width: 100%;\n                        border-collapse: collapse;\n                    }\n                    table, th, td {\n                        border: 1px solid #000;\n                        padding: 5px 10px;\n                        font-size: 12px;\n                    }\n                    th {\n                        background: #555;\n                        color: #fff;\n                    }\n                    .text-center {\n                        text-align: center;\n                    }\n                    div.table-responsive {\n                        margin: 10px;\n                        padding: 10px;\n                        border: 1px solid #000;\n                    }\n                    h4 {\n                        margin-top: 20px;\n                    }\n                    @page {\n                        margin: 0;\n                        size: landscape;\n                    }\n                    </style>\n                </head>\n                <body onload="window.print()">'.concat(t.innerHTML,"</body>\n            </html>");e.document.write(a),e.document.close(),setTimeout((function(){e.close()}),10)},saveAttendence:function(){var t=this,e={attendence:this.attendence,date:this.attd_date,section:this.section};axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).post("save-attendence",e).then((function(e){t.$toast.success("Attendence saved.")}))},getDepts:function(){var t=this;axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).get("get-departments").then((function(e){t.departments=e.data.data}))},getClasses:function(){var t=this;axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).get("get-class-by-dept/"+this.department).then((function(e){t.classes=e.data}))},getStudents:function(){var t=this;if(this.section){var e={section:this.section,date:this.attd_date};axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).post("attd-students",e).then((function(e){t.loaded=1,e.status?(t.students=e.data.data,t.attendence=e.data.attendees,void 0!==e.data.attendees&&0!=e.data.attendees.length||t.students.forEach((function(t,e){this.students[t].attd_count=1}))):t.errors=1})).catch((function(e){t.loaded=1,console.log(e)}))}}}},d=a(0),l=Object(d.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"dashboard-content-one"},[a("div",{staticClass:"breadcrumbs-area"},[a("h3",[t._v("Student Attendence")]),t._v(" "),a("ul",[a("li",[a("router-link",{attrs:{to:{name:"dashboard"}}},[t._v("Dashboard")])],1),t._v(" "),a("li",[t._v("Student Attendence")])])]),t._v(" "),a("div",{staticClass:"mg-b-20"},[a("div",{staticClass:"row gutters-8"},[a("div",{staticClass:"col-4-xxxl col-xl-4 col-lg-3 col-12 form-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.attd_date,expression:"attd_date"}],staticClass:"form-control",attrs:{type:"date",max:t.maxDate,placeholder:"Date",value:""},domProps:{value:t.attd_date},on:{change:function(e){return t.getStudents()},input:function(e){e.target.composing||(t.attd_date=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"col-4-xxxl col-xl-4 col-lg-3 col-12 form-group"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.department,expression:"department"}],staticClass:"form-control",attrs:{required:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.department=e.target.multiple?a:a[0]},function(e){return t.getClasses()}]}},[a("option",{attrs:{value:""}},[t._v("Select Department")]),t._v(" "),t._l(t.departments,(function(e){return a("option",{key:e.id,domProps:{value:e.id}},[t._v(t._s(e.dept_name))])}))],2)]),t._v(" "),a("div",{staticClass:"col-4-xxxl col-xl-4 col-lg-3 col-12 form-group"},[a("select",{directives:[{name:"model",rawName:"v-model",value:t.section,expression:"section"}],staticClass:"form-control",attrs:{required:""},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.section=e.target.multiple?a:a[0]},function(e){return t.getStudents()}]}},[a("option",{attrs:{value:""}},[t._v("Select Class / Section")]),t._v(" "),t._l(t.classes,(function(e){return a("optgroup",{key:e.id,attrs:{label:e.name}},t._l(e.sections,(function(n){return a("option",{key:n.id,domProps:{value:n.id}},[t._v(t._s(e.name)+" - "+t._s(n.name))])})),0)}))],2)])])]),t._v(" "),a("form",{attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.saveAttendence()}}},[t.section?a("div",{staticClass:"card height-auto"},[a("div",{staticClass:"card-body"},[t.loaded?t._e():a("div",{staticClass:"text-center"},[a("img",{staticStyle:{"max-width":"100%"},attrs:{src:"img/preloader.gif",alt:""}})]),t._v(" "),t.loaded?a("div",[a("div",{attrs:{id:"timetable"}},[t.lists?a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table display table-bordered table-sm text-nowrap"},[t._m(0),t._v(" "),a("tbody",t._l(t.students,(function(e,n){return a("tr",{key:n},[a("td",{staticClass:"text-center"},[t._v("\n                                            "+t._s(n+1)+"\n                                        ")]),t._v(" "),a("td",{staticClass:"text-center"},[t._v(t._s(e.name))]),t._v(" "),a("td",{staticClass:"text-center"},[t._v(t._s(e.student_data&&e.student_data.father_info?e.student_data.father_info.name:""))]),t._v(" "),a("td",{staticClass:"text-center"},[a("div",{staticClass:"onoffswitch d-inline-block my-1"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.attendence,expression:"attendence"}],key:n,staticClass:"onoffswitch-checkbox",attrs:{type:"checkbox",id:"attd_btn"+e.id,tabindex:n},domProps:{value:e.id,checked:e.attd_count,checked:Array.isArray(t.attendence)?t._i(t.attendence,e.id)>-1:t.attendence},on:{change:function(a){var n=t.attendence,s=a.target,i=!!s.checked;if(Array.isArray(n)){var o=e.id,r=t._i(n,o);s.checked?r<0&&(t.attendence=n.concat([o])):r>-1&&(t.attendence=n.slice(0,r).concat(n.slice(r+1)))}else t.attendence=i}}}),t._v(" "),a("label",{staticClass:"onoffswitch-label m-0 text-left",attrs:{for:"attd_btn"+e.id}},[a("span",{staticClass:"onoffswitch-inner"}),t._v(" "),a("span",{staticClass:"onoffswitch-switch"})])])])])})),0)])]):t._e()]),t._v(" "),t._m(1)]):t._e()])]):t._e()])])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",{staticClass:"thead-dark"},[e("tr",[e("th",{staticClass:"text-center"},[this._v("\n                                            #\n                                        ")]),this._v(" "),e("th",{staticClass:"text-center"},[this._v("NAME")]),this._v(" "),e("th",{staticClass:"text-center"},[this._v("FATHER")]),this._v(" "),e("th",{staticClass:"text-center"},[this._v("Attendence")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"text-center"},[e("button",{staticClass:"btn-fill-lg btn-gradient-yellow btn-hover-bluedark",attrs:{type:"submit"}},[this._v(" Save ")])])}],!1,null,null,null);e.default=l.exports}}]);