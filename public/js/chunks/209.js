(window.webpackJsonp=window.webpackJsonp||[]).push([[209],{585:function(t,e,n){"use strict";n.r(e);n(4);var a={data:function(){return{errors:0,department:"",section:"",class_full_name:"",departments:[],classes:[],timeslots:[],weekdays:[],lists:[],allSelected:0,check:[],subject:{},teacher:{},subject_lists:[],teacher_lists:[],s:"",loaded:0,editFlag:!1,token:localStorage.getItem("token")}},mounted:function(){this.getDepts()},methods:{editAction:function(t){this.editFlag=t},updateData:function(){var t=this,e={subject:this.subject,teacher:this.teacher,department:this.department,section:this.section};axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).post("timetable/edit",e).then((function(e){t.$toast.success("Timetable updated successfully."),t.editAction(!1),t.getTimetable()}))},printTimeTable:function(){var t=document.getElementById("timetable"),e=window.open("","Time-Table","width=800,height=600");e.document.open();var n='\n            <html>\n                <head>\n                    <title>Time-Table</title>\n                    <style>\n                    body {\n                        margin:0;\n                        font-family: sans-serif;\n                    }\n                    table {\n                        width: 100%;\n                        border-collapse: collapse;\n                    }\n                    table, th, td {\n                        border: 1px solid #000;\n                        padding: 5px 10px;\n                        font-size: 8px;\n                    }\n                    th {\n                        background: #555;\n                        color: #fff;\n                    }\n                    .text-center {\n                        text-align: center;\n                    }\n                    div.table-responsive {\n                        margin: 15px;\n                        padding: 10px;\n                        border: 1px solid #000;\n                    }\n                    h4 {\n                        margin-top: 20px;\n                        text-align: center;\n                    }\n                    button {\n                        display: none;\n                    }\n                    @page {\n                        margin: 0;\n                        size: A4 landscape;\n                    }\n                    </style>\n                </head>\n                <body onload="window.print()">'.concat(t.innerHTML,"</body>\n            </html>");e.document.write(n),e.document.close(),setTimeout((function(){e.close()}),10)},getDepts:function(){var t=this;axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).get("get-departments").then((function(e){t.departments=e.data.data,null!=params.id&&""!=params.id?t.getInfo(params.id):t.loaded=1}))},getClasses:function(){var t=this;axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).get("get-class-by-dept/"+this.department).then((function(e){t.classes=e.data}))},getDropdowns:function(){var t=this;axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).get("get-timetable-dropdowns").then((function(e){t.subject_lists=e.data.subjects,t.teacher_lists=e.data.teachers}))},getTimetable:function(){var t=this,e=(this.department,this.section,{department_id:this.department,section_id:this.section}),n=axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}),a=this;n.post("view-timetable",e).then((function(e){if(a.loaded=1,e.status){a.timeslots=e.data.timeslots,a.lists=e.data.data,a.weekdays=e.data.weekdays,a.class_full_name=e.data.class_full_name,a.getDropdowns();var n=[],i=[];a.lists.forEach((function(t,e){n[t.timeslot_id]={},i[t.timeslot_id]={},a.weekdays.forEach((function(e,a){n[t.timeslot_id][e]=t[e]&&t[e].subject_info?t[e].subject_info.id:"",i[t.timeslot_id][e]=t[e]&&t[e].teacher_info?t[e].teacher_info.id:""}))})),t.subject=n,t.teacher=i}else a.errors=1})).catch((function(e){t.loaded=1,console.log(e)}))}}},i=n(0),s=Object(i.a)(a,(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"dashboard-content-one"},[n("div",{staticClass:"breadcrumbs-area"},[n("h3",[t._v("Student Timetable")]),t._v(" "),n("ul",[n("li",[n("router-link",{attrs:{to:{name:"dashboard"}}},[t._v("Dashboard")])],1),t._v(" "),n("li",[t._v("Student Timetable")])])]),t._v(" "),n("div",{staticClass:"mg-b-20"},[n("div",{staticClass:"row gutters-8"},[n("div",{staticClass:"col-4-xxxl col-xl-4 col-lg-3 col-12 form-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.department,expression:"department"}],staticClass:"form-control",attrs:{required:""},on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.department=e.target.multiple?n:n[0]},function(e){return t.getClasses()}]}},[n("option",{attrs:{value:""}},[t._v("Select Department")]),t._v(" "),t._l(t.departments,(function(e){return n("option",{key:e.id,domProps:{value:e.id}},[t._v("\n            "+t._s(e.dept_name)+"\n          ")])}))],2)]),t._v(" "),n("div",{staticClass:"col-4-xxxl col-xl-4 col-lg-3 col-12 form-group"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.section,expression:"section"}],staticClass:"form-control",attrs:{required:""},on:{change:[function(e){var n=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.section=e.target.multiple?n:n[0]},function(e){return t.getTimetable()}]}},[n("option",{attrs:{value:""}},[t._v("Select Section")]),t._v(" "),t._l(t.classes,(function(e){return n("optgroup",{key:e.id,attrs:{label:e.name}},t._l(e.sections,(function(a){return n("option",{key:a.id,domProps:{value:a.id}},[t._v("\n              "+t._s(e.name)+" - "+t._s(a.name)+"\n            ")])})),0)}))],2)])])]),t._v(" "),n("form",{attrs:{method:"post"},on:{submit:function(e){return e.preventDefault(),t.deleteRecord()}}},[t.section?n("div",{staticClass:"card height-auto"},[n("div",{staticClass:"card-body"},[t.loaded?t._e():n("div",{staticClass:"text-center"},[n("b-spinner")],1),t._v(" "),t.loaded?n("div",[n("div",{attrs:{id:"timetable"}},[t.editFlag?t._e():n("button",{staticClass:"btn btn-dark float-right",staticStyle:{"@media print {display":"none}"},attrs:{type:"button"},on:{click:function(e){return t.editAction(!0)}}},[n("i",{staticClass:"icon-pencil"}),t._v(" Edit\n            ")]),t._v(" "),t.editFlag?n("button",{staticClass:"btn btn-dark float-right",staticStyle:{"@media print {display":"none}"},attrs:{type:"button"},on:{click:function(e){return t.editAction(!1)}}},[n("i",{staticClass:"icon-times"}),t._v(" Close\n            ")]):t._e(),t._v(" "),n("h4",[t._v("Time-Table for Class "+t._s(t.class_full_name))]),t._v(" "),t.lists?n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table display table-bordered text-nowrap",staticStyle:{"font-size":"10px"}},[n("thead",[n("tr",[n("th",{staticClass:"text-center bg-dark text-white"},[t._v("Day")]),t._v(" "),t._l(t.weekdays,(function(e,a){return n("th",{key:a,staticClass:"text-center bg-dark text-white"},[t._v("\n                      "+t._s(e)+"\n                    ")])}))],2)]),t._v(" "),n("tbody",t._l(t.lists,(function(e,a){return n("tr",{key:a},[n("th",{staticClass:"text-center bg-dark text-white"},[n("div",[t._v(t._s(e.timeslot))]),t._v(" "),n("div",[t._v("\n                        "+t._s(e.timeslot_time)+"\n                      ")])]),t._v(" "),t._l(t.weekdays,(function(a,i){return n("td",{key:i,staticClass:"text-center"},[0==t.editFlag?n("div",[n("div",[n("strong",[t._v(t._s(e[a]&&e[a].subject_info?e[a].subject_info.name:"-"))])]),t._v(" "),n("div",[t._v("\n                          "+t._s(e[a]&&e[a].teacher_info?"("+e[a].teacher_info.name+")":"")+"\n                        ")])]):t._e(),t._v(" "),1==t.editFlag?n("div",[n("div",{staticClass:"mb-1"},[n("select",{directives:[{name:"model",rawName:"v-model",value:t.subject[e.timeslot_id][a],expression:"subject[x.timeslot_id][w]"}],staticClass:"form-control",on:{change:function(n){var i=Array.prototype.filter.call(n.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.subject[e.timeslot_id],a,n.target.multiple?i:i[0])}}},[n("option",{attrs:{value:""}},[t._v("Select Subject")]),t._v(" "),t._l(t.subject_lists,(function(e,a){return n("option",{key:a,domProps:{value:e.id}},[t._v("\n                              "+t._s(e.name)+"\n                            ")])}))],2)]),t._v(" "),n("div",[n("select",{directives:[{name:"model",rawName:"v-model",value:t.teacher[e.timeslot_id][a],expression:"teacher[x.timeslot_id][w]"}],staticClass:"form-control",on:{change:function(n){var i=Array.prototype.filter.call(n.target.options,(function(t){return t.selected})).map((function(t){return"_value"in t?t._value:t.value}));t.$set(t.teacher[e.timeslot_id],a,n.target.multiple?i:i[0])}}},[n("option",{attrs:{value:""}},[t._v("Select Teacher")]),t._v(" "),t._l(t.teacher_lists,(function(e,a){return n("option",{key:a,domProps:{value:e.id}},[t._v("\n                              "+t._s(e.name)+"\n                            ")])}))],2)])]):t._e()])}))],2)})),0)])]):t._e()]),t._v(" "),n("div",{staticClass:"text-center"},[t.editFlag?t._e():n("button",{staticClass:"btn-fill-lg btn-gradient-yellow btn-hover-bluedark",attrs:{type:"button"},on:{click:function(e){return t.printTimeTable()}}},[t._v("\n              Print\n            ")]),t._v(" "),t.editFlag?n("button",{staticClass:"btn-fill-lg btn-gradient-yellow btn-hover-bluedark",attrs:{type:"button"},on:{click:function(e){return t.updateData()}}},[t._v("\n              Save & Update\n            ")]):t._e()])]):t._e()])]):t._e()])])}),[],!1,null,null,null);e.default=s.exports}}]);