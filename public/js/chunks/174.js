(window.webpackJsonp=window.webpackJsonp||[]).push([[174],{547:function(t,e,s){"use strict";s.r(e);var a={data:function(){return{id:"",user:"",user_info:{},book:"",books:[],record:{},lists:{},allSelected:!1,check:[],errors:[],loaded:1,render:0,token:localStorage.getItem("token")}},mounted:function(){this.$route.params},methods:{rerenderSelf:function(){this.$emit("rerender",Date.now())},scanLibPass:function(){var t=this,e=this.user;if(""!=e&&null!=e){var s={barcode:e};axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).post("book/pass/info-by-barcode",s).then((function(e){t.user_info=e.data.data}))}},scanLibBook:function(){var t=this,e=this.book,s=!1;for(b in this.books)b.barcode==e&&(s=!0);if(""!=e&&null!=e&&0==s){var a={barcode:e};axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).post("book/info-by-barcode",a).then((function(e){t.books.push(e.data)}))}},saveData:function(){var t=this,e=[];this.books.forEach((function(t,s){e.push(t.id)}));var s={pass:this.user_info.id,books:e};axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).post("lms/book/issue",s).then((function(e){e.data.status?(t.$toast.success("Book issued successfully."),t.user="",t.user_info="",t.book="",t.books=""):t.$toast.error("Data not saved, please try again.")})).catch((function(t){console.log(t)}))},getInfo:function(){var t=this;axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).get("lms/setting").then((function(e){t.id=e.data.id,t.record=e.data,t.loaded=1,$(".select2").each((function(){$(this).trigger("change")}))}))},updateData:function(){var t=this,e={record:this.record};$("#lms_settings").is_valid()&&this.user_info.id&&(this.loaded=0,this.errors=[],axios.create({baseURL:this.apiBaseUrl,headers:{Authorization:"Bearer "+this.token,Accept:"application/json"}}).post("lms/book/issue",e).then((function(e){t.loaded=1,e.data.status?(t.record={},t.$toast.success(e.data.message),t.$forceUpdate()):t.errors=e.data.errors})).catch((function(e){t.loaded=1,console.log(e)})))}}},o=s(0),i=Object(o.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"dashboard-content-one"},[s("div",{staticClass:"breadcrumbs-area"},[s("h3",[t._v("Issue Book")]),t._v(" "),s("ul",[s("li",[s("router-link",{attrs:{to:{name:"dashboard"}}},[t._v("Dashboard")])],1),t._v(" "),s("li",[t._v("Issue Book")])])]),t._v(" "),t.loaded?s("div",[t.loaded?t._e():s("div",{staticClass:"text-center"},[s("img",{staticStyle:{"max-width":"100%"},attrs:{src:t.baseURL+"img/preloader.gif",alt:"Loading"}})]),t._v(" "),s("div",{staticClass:"card height-auto"},[s("div",{staticClass:"card-body"},[s("div",[t.loaded?t._e():s("div",{staticClass:"text-center"},[s("img",{staticStyle:{"max-width":"100%"},attrs:{src:"img/preloader.gif",alt:""}})]),t._v(" "),t.loaded?s("div",[s("div",{staticClass:"row mb-3"},[s("div",{staticClass:"col-sm-7"},[s("div",{staticClass:"form-group"},[s("label",[t._v("Scan Library Pass")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.user,expression:"user"}],ref:"user",staticClass:"form-control",attrs:{type:"text",autofocus:""},domProps:{value:t.user},on:{change:function(e){return t.scanLibPass()},input:function(e){e.target.composing||(t.user=e.target.value)}}})]),t._v(" "),t.user_info.id?s("div",{staticClass:"form-group"},[s("label",[t._v("Scan Book")]),t._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:t.book,expression:"book"}],ref:"book",staticClass:"form-control",attrs:{type:"text",autofocus:""},domProps:{value:t.book},on:{change:function(e){return t.scanLibBook()},input:function(e){e.target.composing||(t.book=e.target.value)}}})]):t._e()]),t._v(" "),s("div",{staticClass:"col-sm-5"},[t.user_info.id?s("table",{staticClass:"table table-bordered"},[s("tr",[s("th",[t._v("ID")]),t._v(" "),s("td",[t._v(t._s(t.user_info.barcode))])]),t._v(" "),s("tr",[s("th",[t._v("NAME")]),t._v(" "),s("td",[t._v(t._s(t.user_info.name))])]),t._v(" "),s("tr",[s("th",[t._v("ROLE")]),t._v(" "),s("td",[t._v(t._s(t.user_info.type))])]),t._v(" "),s("tr",[s("th",[t._v("LIMIT OF BOOKS")]),t._v(" "),s("td",[t._v(t._s(t.user_info.book_issue_limit))])])]):t._e()])]),t._v(" "),t.books.length&&t.user_info.id?s("div",{staticClass:"table-responsive mb-3"},[s("table",{staticClass:"table table-bordered"},[t._m(0),t._v(" "),s("tbody",t._l(t.books,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(a+1))]),t._v(" "),s("td",[t._v(t._s(e.title))]),t._v(" "),s("td",[t._v(t._s(e.author))]),t._v(" "),s("td",[t._v(t._s(e.publication_year))])])})),0)])]):t._e(),t._v(" "),t.user_info.id&&t.books.length?s("div",{staticClass:"form-group mg-t-8"},[s("button",{staticClass:"btn-fill-lg btn-gradient-yellow btn-hover-bluedark",attrs:{type:"button"},on:{click:function(e){return t.saveData()}}},[t._v("Submit")]),t._v(" "),s("button",{staticClass:"btn-fill-lg bg-blue-dark btn-hover-yellow",attrs:{type:"reset"}},[t._v("Reset")])]):t._e()]):t._e()])])])]):t._e()])}),[function(){var t=this.$createElement,e=this._self._c||t;return e("thead",[e("tr",[e("th",[this._v("S.No.")]),this._v(" "),e("th",[this._v("DESCRIPTION")]),this._v(" "),e("th",[this._v("Author")]),this._v(" "),e("th",[this._v("Publication")])])])}],!1,null,null,null);e.default=i.exports}}]);